import{G as A,h as b,u as P,r as d,d as p,j as e,s as $,t as v,e as q,y as T,v as B,l as G,w as L,f}from"./index-C8NdgHJU.js";import{S as I}from"./SliderNext-D_q0K2mr.js";import"./index-BaLfM6_6.js";function z(o){return A({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(o)}const H=async()=>{const o=f.get("accessToken"),r=await fetch("http://localhost:3000/api/v1/admin/category?page=1",{method:"GET",headers:{Accept:"*/*",Authorization:`Bearer ${o}`}});if(!r.ok)throw new Error("خطا در دریافت داده‌ها");return(await r.json()).categories},K=async o=>{const r=f.get("accessToken");if(!r)throw new Error("توکن یافت نشد. لطفاً وارد شوید.");const s=await fetch(`http://localhost:3000/api/v1/client/subCategories/category/${o}`,{method:"GET",headers:{Accept:"*/*",Authorization:`Bearer ${r}`}});if(!s.ok)throw new Error("خطا در دریافت زیرشاخه‌ها");return(await s.json()).subCategories||[]},R=async o=>{const r=f.get("accessToken"),s=await fetch(`http://localhost:3000/api/v1/client/products/${o}?page=1`,{method:"GET",headers:{Accept:"*/*",Authorization:`Bearer ${r}`}});if(!s.ok)throw new Error("خطا در دریافت محصولات");return(await s.json()).products},M=()=>{const o=b(t=>t.cardReducer.products);console.log(o);const r=P(),[s,m]=d.useState(5),[l,g]=d.useState(""),{data:x,isLoading:y,error:N}=p({queryKey:["main category"],queryFn:H}),{data:i,refetch:j}=p({queryKey:["subcategory",s],queryFn:()=>K(s),enabled:!!s}),{data:n,isLoading:C,refetch:w}=p({queryKey:["products",l],queryFn:()=>R(l),enabled:!!l});d.useEffect(()=>{i&&i.length>0&&!l&&g(i[0].id.toString())},[i]),d.useEffect(()=>{s&&j()},[s,j]),d.useEffect(()=>{l&&w()},[l,w]);const k=b(t=>t.cardReducer.products),F=t=>k.some(c=>c.id===t);if(console.log(i),y||C)return e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx("div",{className:"h-16 w-16 animate-spin rounded-full border-t-4 border-b-4 border-[#417F56]"})});if(N)return e.jsx("p",{children:"خطا در دریافت داده‌ها"});const h=x==null?void 0:x.slice(0,4),E=t=>{const c=n==null?void 0:n.map(a=>a.id===t?{...a,isFavorite:!a.isFavorite}:a);console.log(c)},S=(t,c)=>{const a=n==null?void 0:n.map(u=>u.id===t?{...u,rating:c}:u);console.log(a)};return e.jsxs(e.Fragment,{children:[e.jsx(I,{}),e.jsxs("div",{className:"container mx-auto px-5",children:[e.jsx("div",{className:"mt-5 flex flex-wrap items-center justify-end gap-4 rounded-2xl bg-[#F8F8F8] p-7 shadow-md sm:flex-row sm:gap-8",children:h==null?void 0:h.map(t=>e.jsx("div",{className:`cursor-pointer text-lg font-medium text-[#5A5A5A] transition-all duration-300 ease-in-out hover:scale-110 hover:font-bold hover:text-[#417F56] ${t.id===s?"scale-110 border-b-2 border-[#417F56] font-bold text-[#417F56]":""}`,onClick:()=>m(t.id),children:e.jsx("h3",{children:t.title})},t.id))}),e.jsxs("div",{className:"mx-auto mt-6 flex w-full max-w-3xl flex-col items-center gap-4 sm:flex-row sm:gap-6",children:[e.jsx("form",{className:"flex-1",children:e.jsx("input",{className:"h-12 w-full rounded-full bg-[#ECECEC] px-5 text-black transition-all duration-300 outline-none focus:bg-white focus:ring-2 focus:ring-[#417F56]",type:"text",placeholder:"جستجو..."})}),e.jsxs("div",{className:"relative w-full sm:w-52",children:[e.jsx("select",{value:l||"",onChange:t=>g(t.target.value),className:"h-12 w-full cursor-pointer appearance-none rounded-full bg-[#417F56] px-6 pr-10 text-white shadow-md transition-all duration-300 outline-none hover:bg-[#355E44] hover:shadow-lg focus:ring-2 focus:ring-[#2E5E3A] sm:w-50",children:i&&Array.isArray(i)&&i.map(t=>e.jsx("option",{value:t.id,children:t.title},t.id))}),e.jsx(z,{className:"absolute top-1/2 right-5 -translate-y-1/2 text-xl text-white transition-transform duration-300 ease-in-out"})]})]}),e.jsx("div",{className:"mt-10 flex items-center justify-between",children:e.jsxs("button",{className:"flex h-10 w-44 cursor-pointer items-center justify-center gap-3 rounded-2xl border border-[#417F56] bg-white p-2 text-[#417F56] shadow-md transition-all duration-300 ease-in-out hover:scale-105 hover:bg-[#417F56] hover:text-white",children:[e.jsx("p",{className:"text-base font-medium",children:"تکمیل خرید"}),e.jsx($,{className:"h-6 w-6"})]})}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-2xl font-semibold",children:"محصولات"}),e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2",children:n==null?void 0:n.map(t=>e.jsxs("div",{className:"flex flex-col items-center justify-between rounded-lg bg-white p-4 shadow-md transition-all duration-300 hover:scale-105 sm:flex-row sm:gap-6",style:{minHeight:"158px"},children:[e.jsx("img",{src:`http://localhost:3000/${t.image_url}`,alt:"",className:"h-[158px] w-[230px] rounded-md object-cover transition-transform duration-300 hover:scale-105 sm:block md:hidden"}),e.jsxs("div",{className:"mt-4 flex w-full flex-col sm:mr-4 sm:w-2/3 sm:pl-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"cursor-pointer transition-transform duration-300 hover:scale-125",onClick:()=>E(t.id),children:t.isFavorite?e.jsx(v,{className:"h-[24px] w-[24px] text-red-500 transition-all duration-300"}):e.jsx(v,{className:"h-[24px] w-[24px] text-gray-500 transition-all duration-300"})}),e.jsx("h4",{className:"text-[16px] font-semibold sm:text-[20px]",children:t.name})]}),e.jsxs("div",{className:"mt-5 flex items-center justify-between",children:[e.jsxs("p",{className:"text-[14px] text-[#353535] sm:text-[18px]",children:[e.jsxs("span",{children:[t.price," "]}),e.jsx("span",{children:"تومان"})]}),e.jsx("p",{className:"text-[12px] text-[#353535] sm:text-[14px]",children:t.description})]}),e.jsx("div",{className:"mt-2 flex w-fit border bg-green-200",children:t.qty}),e.jsxs("div",{className:"mt-5 mb-6 flex items-center justify-center gap-1",children:[e.jsx("button",{onClick:()=>{r(q(t)),T.success("✅ محصول با موفقیت به سبد خرید اضافه شد!",{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})},className:"flex h-[40px] w-[100%] cursor-pointer items-center justify-center rounded-md bg-[#417F56] font-semibold text-white disabled:bg-white disabled:text-gray-500 sm:w-[244px]",children:"افزودن به سبد خرید"}),F(t.id)&&e.jsx("button",{onClick:()=>r(G(t)),className:"mt-2 rounded-2xl border-1 border-stone-400 p-2 sm:mt-0",children:e.jsx(B,{})}),[...Array(5)].map((c,a)=>e.jsx(L,{className:`h-[20px] w-[20px] cursor-pointer transition-all duration-300 sm:h-[24px] sm:w-[24px] ${a<t.rating?"text-yellow-400":"text-gray-300"}`,onClick:()=>S(t.id,a+1)},a))]})]}),e.jsx("img",{src:`http://localhost:3000/${t.image_url}`,alt:"",className:"hidden h-[158px] w-[230px] rounded-md object-cover transition-transform duration-300 hover:scale-105 md:block"})]},t.id))})]})]})]})};export{M as default};
